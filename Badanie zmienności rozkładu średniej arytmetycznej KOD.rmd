---
title: "Badanie zmiennoci rozkadu redniej arytmetycznej"
author: "Olga Sieradzan, Aleksandra Wgrzyn"
date: "2023-12-21"
output: 
  html_document:
    toc: true
    toc_float: 
      smooth_scrool: true
    df_print: paged
    theme: united
---

***

W badaniu rozwa偶amy **rozkad Poissona** z  = 1 i  = 40.

```{r, echo = FALSE, message = FALSE, warning = FALSE}
set.seed(234)

# Wczytanie potrzebnych pakiet贸w
library(cowplot)
library(moments)
library(ggplot2)
library(tidyr)
library (dplyr)
```

***
# Wariant pierwszy 

## 0. Podstawowe charakterystyki rozkadu Poissona

**Rozkad Poissona** jest rozkadem dyskretnym o zbiorze wartoci 
X = {0, 1, 2, ...}.

Zmienna losowa X ma rozkad Poissona z parametrem  > 0 je偶eli jej funkcja prawdopodobiestwa opisana jest wzorem:

**P (X = k) = $\frac{^{k}}{k!}$ 	$e^{-}$**
dla k = 0, 1, 2, ...

Ponadto rozkad Poissona posiada wasnoci: 

 - **E(X) = 位**
 - **Var(X) = 位**

Chcc wyznaczy podstawowe charakterystyki rozkadu Poissona z parametrami 位 = 1 oraz 位 = 40, generujemy 300 danych pochodzcych z tego rozkadu. Wartoci statystyk zamieszczamy w poni偶szych tabelach:

*Tabela 1.1. Podstawowe statystyki rozkadu Poissona z parametrem 位 = 1*
```{r echo = FALSE}
data1 <- rpois(300, 1)

rednia <- mean(data1)
odch_stand <- sd(data1)
skono <- skewness(data1)
kurtoza <- kurtosis(data1)
statystyki1 <- data.frame(rednia, odch_stand, skono, kurtoza)
statystyki1
```

*Tabela 1.2. Podstawowe statystyki rozkadu Poissona z parametrem 位 = 40*
```{r echo = FALSE}
data2 <- rpois(300, 40)

rednia <- mean(data2)
odch_stand <- sd(data2)
skono <- skewness(data2)
kurtoza <- kurtosis(data2)
statystyki2 <- data.frame(rednia, odch_stand, skono, kurtoza)
statystyki2
```

```{r warning = FALSE, echo = FALSE}
x <- seq(0, 8, by = 1)
y <- dpois(x, lambda = 1)

plot(y, main = "Rozkad teoretyczny Poissona", xlab = "", ylab = "",pch = 21, bg = "red", cex = 1.3)
```

***

## 1-3. Wygenerowanie danych i wyliczenie redniej arytmetycznej

Zamiast N = 300, postanowiymy zamieni je na N = 800.

```{r echo = FALSE}
k <- c(5,10,20,30,50,100,200,500,1000)
```

Wylosowaymy dane z rozkadu Poissona z parametrami odpowiednio *位 = 1* 
oraz *位 = 40*, kt贸re nastepnie zostay poniesione do kwadratu. W poni偶szych tabelach umieciymy wyliczone rednie arytmetyczne tych danych dla konkretnych k.


*Tabela 1.3. Zestawienie wyznaczonych wartoci w zale偶noci od k*
*dla danych z rozkadu Poissona z parametrem 位 = 1*
```{r echo = FALSE}

x <- (1:9)
lambda <- data.frame(NA)
lambda1_1 <- data.frame(x)

for (i in 2:801) {

lambda <- cbind(c(rpois(k[1], 1), rep(NA, 995)),
                 c(rpois(k[2], 1), rep(NA, 990)),
                 c(rpois(k[3], 1), rep(NA, 980)),
                 c(rpois(k[4], 1), rep(NA, 970)),
                 c(rpois(k[5], 1), rep(NA, 950)),
                 c(rpois(k[6], 1), rep(NA, 900)),
                 c(rpois(k[7], 1), rep(NA, 800)),
                 c(rpois(k[8], 1), rep(NA, 500)),
                 rpois(k[9], 1)
                 )
lambda

lambda1_1[,i] <- colMeans(lambda, na.rm = T)
lambda <- data.frame(NA)
i = i+1

}

lambda1_1 <- lambda1_1[,-c(1)]
rownames(lambda1_1) <- c("5","10","20","30","50","100","200","500","1000")

lambda1_1
```

\
*Tabela 1.4. Zestawienie wyznaczonych wartoci w zale偶noci od k*
*dla danych z rozkadu Poissona z parametrem 位 = 40*
```{r echo = FALSE}

y <- (1:9)
lambda <- data.frame(NA)
lambda40_1 <- data.frame(y)

for (i in 2:801) {

lambda <- cbind(c(rpois(k[1], 40), rep(NA,995)),
                 c(rpois(k[2], 40), rep(NA,990)),
                 c(rpois(k[3], 40), rep(NA,980)),
                 c(rpois(k[4], 40), rep(NA,970)),
                 c(rpois(k[5], 40), rep(NA,950)),
                 c(rpois(k[6], 40), rep(NA,900)),
                 c(rpois(k[7], 40), rep(NA,800)),
                 c(rpois(k[8], 40), rep(NA,500)),
                 rpois(k[9], 40)
                 )

lambda40_1[,i] <- colMeans(lambda, na.rm = T)
lambda <- data.frame(NA)
i= i+1

}

lambda40_1

lambda40_1 <- lambda40_1[,-c(1)]
rownames(lambda40_1) <- c("5","10","20","30","50","100","200","500","1000")
```
***

## 4. Podstawowe charakterystyki zbioru obliczonych rednich arytmetycznych

### rednia arytmetyczna

*Tabela 1.5. Zestawienie rednich arytmetycznych w zale偶noci od k* 
*dla danych z rozkadu Poissona z parametrem 位 = 1*
```{r echo = FALSE}
srednia1 <- round(apply(lambda1_1, 1, mean), 3)
df1 <- data.frame(t(srednia1))
names(df1) <- k
df1
```

\
```{r echo = FALSE, warning = FALSE}
ggplot() +
  geom_point(aes(y = k, x = round(apply(lambda1_1, 1, mean), 3)), 
             col = "steelblue", size = 3.5) +
  xlim(0.97, 1.03) +
  geom_line(aes(y = k, x = 1)) +
  theme_light(base_size = 12) +
  labs(y = "k",
       x = "rednia arytmetyczna",
       title = "rednia arytmetyczna w zale偶noci od k",
       subtitle = "Dane pochodz z rozkadu Poissona o 位 = 1")
```

Czarna linia reprezentuje warto oczekiwan rozkadu.

Wartoci rednich s zdecydowanie bardziej rozproszone dla maych k. Dla bardzo du偶ego k r贸偶nica jest minimalna.
Wszystkie r贸偶nice s nie wiksze ni偶 0.07.

***

*Tabela 1.6. Zestawienie rednich arytmetycznych w zale偶noci od k* 
*dla danych z rozkadu Poissona z parametrem 位 = 40*
```{r echo = FALSE}
srednia2 <- round(apply(lambda40_1, 1, mean), 3)
df2 <- data.frame(t(srednia2))
names(df2) <- k
df2
```
\

```{r echo = FALSE, warning = FALSE}
ggplot() +
  geom_point(aes(y = k, x = round(apply(lambda40_1, 1, mean), 3)), 
                 col = "#9ACD32", size = 3.5) +
  xlim(39.8, 40.2) +
  geom_line(aes(y = k, x = 40)) +
  theme_light(base_size = 12) +
  labs(y = "k",
       x = "rednia arytmetyczna",
       title = "rednia arytmetyczna w zale偶noci od k",
       subtitle = "Dane pochodz z rozkadu Poissona o 位 = 40")
```

W tym przypadku r贸wnie偶 zr贸偶nicowanie rednich jest najwiksze na spodzie wykresu. I tym razem r贸偶nice nie s wiksze ni偶 0.07.

***

### Odchylenie standardowe

***
*Tabela 1.7. Zestawienie odchyle standardowych w zale偶noci od k*
*dla danych z rozkadu Poissona z parametrem 位 = 1*
```{r echo = FALSE}
odch1 <- round(apply(lambda1_1, 1, sd), 3)
df3 <- data.frame(t(odch1))
names(df3) <- k
df3
```

\
```{r echo = FALSE}
ggplot() +
  geom_point(aes(y = k, x = round(apply(lambda1_1, 1, sd), 3)), 
             col = "steelblue", size = 3.5) +
  theme_light(base_size = 12) +
  labs(y = "k",
       x = "Odchylenie standardowe",
       title = "Odchylenie standardowe w zale偶noci od k",
       subtitle = "Dane pochodz z rozkadu Poissona o 位 = 1")
```

Wykres jednoznacznie wskazuje na drastyczny wzrost odchylenia standardowego wraz ze spadkiem k.

***
*Tabela 1.7. Zestawienie odchyle standardowych w zale偶noci od k*
*dla danych z rozkadu Poissona z parametrem 位 = 40*
```{r echo = FALSE}
odch2 <- round(apply(lambda40_1, 1, sd), 3)
df4 <- data.frame(t(odch2))
names(df4) <- k
df4
```

\
```{r echo = FALSE}
ggplot()+
  geom_point(aes(y = k, x = round(apply(lambda40_1, 1, sd),3)), 
             col = "#9ACD32", size = 3.5) +
  theme_light(base_size = 12) +
  labs(y = "k",
       x = "Odchylenie standardowe",
       title = "Odchylenie standardowe w zale偶noci od k",
       subtitle = "Dane pochodz z rozkadu Poissona o 位 = 40")
```

Ponownie pojawia sie ta zale偶no, tylko tym razem wida r贸偶nice midzy najni偶szymi odczytami odchylenia standardowego dla r贸偶nych lambd.

Dla lambda = 1, byo to praktycznie 0, tutaj 0.2.

***

### Skono

***
*Tabela 1.8. Zestawienie wsp贸czynnik贸w skonoci w zale偶noci od k*
*dla danych z rozkadu Poissona z parametrem 位 = 1*
```{r echo = FALSE}
skosnosc1 <- round(apply(lambda1_1, 1, skewness), 3)
df5 <- data.frame(t(skosnosc1))
names(df5) <- k
df5
```

\
```{r echo = FALSE}
ggplot() +
  geom_point(aes(y =k, x = round(apply(lambda1_1, 1, skewness), 3)), 
             col = "steelblue", size = 3.5) +
  theme_light(base_size = 12) +
  geom_line(aes(y = k, x = 0)) +
  labs(y = "k",
       x = "Skono",
       title = "Skono w zale偶noci od k",
       subtitle = "Dane pochodz z rozkadu Poissona o 位 = 1")
```

Wsp贸czynnik asymetrii, gdy jest dodatni, oznacza asymetri prawostronn. W tym przypadku wszystkie odczyty s dodatnie. Ponadto wida, 偶e skono rozkadu jest zdecydowanie mniejsza dla du偶ych k.

***
*Tabela 1.9. Zestawienie wsp贸czynnik贸w skonoci w zale偶noci od k*
*dla danych z rozkadu Poissona z parametrem 位 = 40*
```{r echo = FALSE}
skosnosc2 <- round(apply(lambda40_1, 1, skewness), 3)
df6 <- data.frame(t(skosnosc2))
names(df6) <- k
df6
```

\
```{r echo = FALSE}
ggplot() +
  geom_point(aes(y = k, x = round(apply(lambda40_1, 1, skewness), 3)), 
             col = "#9ACD32", size = 3.5) +
  theme_light(base_size = 12) +
  geom_line(aes(y = k, x = 0)) +
  labs(y = "k",
       x = " Skono",
       title = "Skono w zale偶noci od k",
       subtitle = "Dane z rozkadu Poissona o 位 = 40")
```

<div style='text-align: justify;'>
Dla 位 = 40 sytuacja wyglda inaczej. Po pierwsze, skonoci rozkad贸w s zdecydowanie mniejsze w por贸wnaniu z poprzednim przypadkiem oraz wystepuj ujemne wartoci wsp贸czynnika asymetrii, czyli niekt贸re z tych rozkad贸w cechuj si asymetri lewostronn. Pozostaje jednak zale偶no im wiksze k, tym mniejsza skono. 
</div>

***

### Kurtoza

***
*Tabela 1.10. Zestawienie kurtozy w zale偶noci od k*
*dla danych z rozkadu Poissona z parametrem 位 = 1*
```{r echo = FALSE}
kurtoza1 <- round(apply(lambda1_1, 1, kurtosis), 3)
df7 <- data.frame(t(kurtoza1))
names(df7) <- k
df7
```

\
```{r echo = FALSE}
ggplot() +
  geom_point(aes(y = k, x = round(apply(lambda1_1, 1, kurtosis), 3)), 
             col = "steelblue", size = 3.5) +
  theme_light(base_size = 12) +
  geom_line(aes(y = k, x = 3)) +
  labs(y = "k",
       x = "Kurtoza",
       title = "Kurtoza w zale偶noci od k",
       subtitle = "Dane pochodz z rozkadu Poissona o 位 = 1")
```

***
*Tabela 1.11. Zestawienie kurtozy w zale偶noci od k*
*dla danych z rozkadu Poissona z parametrem 位 = 40*
```{r echo = FALSE}
kurtoza2 <- round(apply(lambda40_1, 1, kurtosis), 3)
df8 <- data.frame(t(kurtoza2))
names(df8) <- k
df8
```

\
```{r echo = FALSE}
ggplot() +
  geom_point(aes(y = k, x = round(apply(lambda40_1, 1, kurtosis), 3)), 
             col = "#9ACD32", size = 3.5) +
  theme_light(base_size = 12) +
  geom_line(aes(y = k, x = 3)) +
  labs(y = "k",
       x = "Kurtoza",
       title = "Kurtoza w zale偶noci od k",
       subtitle = "Dane pochodz z rozkadu Poissona o 位 = 40")
```

Skono wysza na tyle niska 偶e mo偶na interpretowa eksces.
Wystpuj zar贸wno rozkady platokurtyczne i leptokurtyczne, chocia偶 r贸偶nica od 3 jest niedu偶a.


```{r echo = FALSE}
lambda1transponowana_1 <- t(lambda1_1)
lambda40transponowana_1 <- t(lambda40_1)
```

***

## 5.Wizualizacja danych

***

### Wykresy gstoci

*Zestawienie wykres贸w gstoci w zale偶noci od k*
*dla danych z rozkadu Poissona z parametrem 位 = 1*
```{r, echo = FALSE, message = FALSE, warning = FALSE}

D <- function(x , kolor, min , max) {
  
  ggplot() +
  geom_density(aes(x = x), fill = kolor , col= "black", alpha = 0.7) +
  xlim(min, max) +
  theme_light() +
  labs (y = NULL,
        x = NULL) 
  
}

min <- -1
max <- 3

r1 <- D(lambda1transponowana_1[,1], "steelblue", min, max)
r2 <- D(lambda1transponowana_1[,2], "steelblue", min, max)
r3 <- D(lambda1transponowana_1[,3], "steelblue", min, max)
r4 <- D(lambda1transponowana_1[,4], "steelblue", min, max)
r5 <- D(lambda1transponowana_1[,5], "steelblue", min, max)
r6 <- D(lambda1transponowana_1[,6], "steelblue", min, max)
r7 <- D(lambda1transponowana_1[,7], "steelblue", min, max)
r8 <- D(lambda1transponowana_1[,8], "steelblue", min, max)
r9 <- D(lambda1transponowana_1[,9], "steelblue", min, max)

plot_grid(r1, r2, r3, r4, align = "hv", label_x = 0.1, label_y = 0.95, labels = c("k = 5","k = 10","k = 20","k = 30"), label_size = 13) 
plot_grid(r5, r6, r7, r8, align = "hv", label_x = 0.1, label_y = 0.95, 
          labels = c("k = 50", "k = 100","k = 200","k = 500"), label_size = 13)
plot_grid(r9, align = "hv", label_x = 0.1, label_y = 0.95, labels = "k = 1000", label_size = 13)
```

Na wykresach jednoznacznie wida zale偶no im wiksze k, tym bardziej wartoci skupiaj si wok贸 wartoci oczekiwanej (kt贸rej estymatorem jest parametr 位). 

***

*Zestawienie wykres贸w gstoci w zale偶noci od k*
*dla danych z rozkadu Poissona z parametrem 位 = 40*
```{r echo = FALSE, message = FALSE, warning = FALSE}

min <- 33
max <- 48
p1 <- D(lambda40transponowana_1[,1], "#9ACD32", min, max)
p2 <- D(lambda40transponowana_1[,2], "#9ACD32", min, max)
p3 <- D(lambda40transponowana_1[,3], "#9ACD32", min, max)
p4 <- D(lambda40transponowana_1[,4], "#9ACD32", min, max)
p5 <- D(lambda40transponowana_1[,5], "#9ACD32", min, max)
p6 <- D(lambda40transponowana_1[,6], "#9ACD32", min, max)
p7 <- D(lambda40transponowana_1[,7], "#9ACD32", min, max)
p8 <- D(lambda40transponowana_1[,8], "#9ACD32", min, max)
p9 <- D(lambda40transponowana_1[,9], "#9ACD32", min, max)
 
plot_grid(p1, p2, p3, p4, align = "hv", label_x = 0.1, label_y = 0.95, 
          labels= c("k = 5", "k = 10", "k = 20", "k = 30"), label_size = 13) 
plot_grid(p5, p6, p7, p8, align = "hv", label_x = 0.1, label_y = 0.95, 
          labels= c("k = 50", "k = 100", "k = 200", "k = 500"), 
          label_size = 13)
plot_grid(p9, align = "hv", label_x = 0.1, label_y = 0.95, labels = "k = 1000", label_size = 13)
```

W tym przypadku wystpuje ta sama zale偶no, tylko 偶e tym razem wartoci na skali x maj wikszy rozstp. 
Oznacza to, 偶e im wiksza lambda, tym szerszy staje si rozkad w por贸wnaniu z mniejszymi lambdami.

### Wykresy pudekowe

***

*Zestawienie wykres贸w pudekowych w zale偶noci od k*
*dla danych z rozkadu Poissona z parametrem 位 = 1*
```{r echo = FALSE}
boxplot(lambda1transponowana_1[,1], lambda1transponowana_1[,2],
        lambda1transponowana_1[,3], lambda1transponowana_1[,4],
        names = c("k = 5", "k = 10","k = 20","k = 30"))

boxplot(lambda1transponowana_1[,5], lambda1transponowana_1[,6],
        lambda1transponowana_1[,7], lambda1transponowana_1[,8],
        lambda1transponowana_1[,9],
        names = c("k = 50", "k = 100","k = 200","k = 500", "k = 1000"))
```

Na wykresach pudekowych jeszcze lepiej wida zw偶anie si rozkadu wraz ze wzrostem k. Prosz zwr贸ci uwag na zmian zakresu osi y midzy wykresami.
Dla k = 5, mamy wartoci odstajce a偶 o ponad 2 od wartoci oczekiwanej, gdzie dla k = 30 jest to maksymalnie 0.6, a dla k = 1000 mniej ni偶 0.2.

***

*Zestawienie wykres贸w pudekowych w zale偶noci od k*
*dla danych z rozkadu Poissona z parametrem 位 = 40*
```{r echo = FALSE}
boxplot(lambda40transponowana_1[,1], lambda40transponowana_1[,2],
        lambda40transponowana_1[,3], lambda40transponowana_1[,4],
        names = c("k = 5", "k = 10","k = 20","k = 30"))

boxplot(lambda40transponowana_1[,5], lambda40transponowana_1[,6],
        lambda40transponowana_1[,7], lambda40transponowana_1[,8],
        lambda40transponowana_1[,9], 
        names = c("k = 50", "k = 100","k = 200","k = 500", "k = 1000"))
```

W tym przypadku r贸偶nica midzy najdalszymi wartociami odstajcymi a wartoci oczekiwan jest r贸wna 10, czyli jest 5 razy wiksza ni偶 dla 位 = 1. 

***

## 6. Badanie normalnoci rozkadu - test Shapiro-Wilka

Za pomoc testu Shapiro - Wilka dokonamy weryfikacji hipotezy o normalnoci badanego przez nas rozkadu. 

**Hipoteza 0: Badany rozkad jest normalny**

**Hipoteza 1: Badany rozkad nie jest normalny** 

poziom istotnoci 伪 = 0.1

*Tabela 1.12. Wartoci p-value dla testu Shapiro-Wilka przeprowadzonego na* *rozkadzie Poissona z parametrem 位 = 1, dla konkretnych k*
```{r echo = FALSE}
set.seed(200)
Shapirotest1_1 <- data.frame(1,2,3,4,5,6,7,8,9)
Shapirotest40_1 <- data.frame(1,2,3,4,5,6,7,8,9)

Shapirotest1_1[1,1] <- shapiro.test(lambda1transponowana_1[,1])$p.value
Shapirotest1_1[1,2] <- shapiro.test(lambda1transponowana_1[,2])$p.value
Shapirotest1_1[1,3] <- shapiro.test(lambda1transponowana_1[,3])$p.value
Shapirotest1_1[1,4] <- shapiro.test(lambda1transponowana_1[,4])$p.value
Shapirotest1_1[1,5] <- shapiro.test(lambda1transponowana_1[,5])$p.value
Shapirotest1_1[1,6] <- shapiro.test(lambda1transponowana_1[,6])$p.value
Shapirotest1_1[1,7] <- shapiro.test(lambda1transponowana_1[,7])$p.value
Shapirotest1_1[1,8] <- shapiro.test(lambda1transponowana_1[,8])$p.value
Shapirotest1_1[1,9] <- shapiro.test(lambda1transponowana_1[,9])$p.value

colnames(Shapirotest1_1) <- c("5","10","20","30","50","100","200","500","1000")
round (Shapirotest1_1, 3)
```

Wizualizacja wynik贸w dla parametru 位 = 1.

Czarna linia na wykresie reprezentuje poziom istotnoci 伪.

Dla wszystkich przypadk贸w jakie wychodz ponad lini, nie ma podstaw do odrzucenia H0.

Dopiero dla k = 500, nie ma podstaw aby stwierdzi 偶e rozkad nie jest normalny. Ta waciwo utrzymuje si cay czas, wraz ze wzrostem k, jednak偶e nie mo偶na stwierdzi zale偶noci im wiksze k, tym wikszy odczyt p-value.

```{r echo = FALSE}
ggplot() +
  geom_point(aes(x = k, y = t(Shapirotest1_1)[,1]), col = "steelblue", 
             size = 3.5) +
  geom_line(aes(x = k, y = 0.1)) +
  theme_light(base_size = 12) +
  labs(y = "p-value",
       x = "k",
       title = "Wartoci p-value dla testu Shapiro-Wilka",
       subtitle = "Dane pochodz z rozkadu Poissona o 位 = 1")
```

***

*Tabela 1.13. Wartoci p-value dla testu Shapiro-Wilka przeprowadzonego na* *rozkadzie Poissona z parametrem 位 = 40, dla konkretnych k*
```{r echo = FALSE}
set.seed (200)
Shapirotest40_1[1,1] <- shapiro.test(lambda40transponowana_1[,1])$p.value
Shapirotest40_1[1,2] <- shapiro.test(lambda40transponowana_1[,2])$p.value
Shapirotest40_1[1,3] <- shapiro.test(lambda40transponowana_1[,3])$p.value
Shapirotest40_1[1,4] <- shapiro.test(lambda40transponowana_1[,4])$p.value
Shapirotest40_1[1,5] <- shapiro.test(lambda40transponowana_1[,5])$p.value
Shapirotest40_1[1,6] <- shapiro.test(lambda40transponowana_1[,6])$p.value
Shapirotest40_1[1,7] <- shapiro.test(lambda40transponowana_1[,7])$p.value
Shapirotest40_1[1,8] <- shapiro.test(lambda40transponowana_1[,8])$p.value
Shapirotest40_1[1,9] <- shapiro.test(lambda40transponowana_1[,9])$p.value

colnames(Shapirotest40_1) <- c("5","10","20","30","50","100","200","500","1000")
round (Shapirotest40_1, 3)
```

Wizualizacja wynik贸w dla 位 = 40.

W tym przypadku tylko dla k = 30 oraz k = 50, mamy podstawy do odrzucenia H0, przy czym dla mniejszego k = 5 nie mo偶emy odrzuci H0. 
```{r echo = FALSE}
ggplot() +
  geom_point(aes(x = k, y = t(Shapirotest40_1)[,1]), col = "#9ACD32", 
             size = 3.5) +
  geom_line(aes(x = k, y = 0.1)) +
  theme_light(base_size = 12) +
  labs(y = "p-value",
       x = "k",
       title = "Wartoci p-value dla testu Shapiro-Wilka",
       subtitle = "Dane pochodz z rozkadu Poissona o 位 = 40")
```
***

### Podsumowanie

W poni偶szych tabelach zamieszczone zostay zestawienia podstawowych charakterystyk rozkadu w zale偶noci od liczby danych wykorzystanych do obliczenia redniej (k).

***

*Tabela 1.14. Zestawienie podstawowych statystyk w zale偶noci od k*
*dla danych z rozkadu Poissona z parametrem 位 = 1*
```{r echo = FALSE}
pods1_1 <- rbind.data.frame(df1, df3, df5, df7)
row.names(pods1_1) <- c("rednia", "odch_stand", "skono", "kurtoza")
pods1_1
```
\

*Tabela 1.15. Zestawienie podstawowych statystyk w zale偶noci od k*
*dla danych z rozkadu Poissona z parametrem 位 = 40*
```{r echo = FALSE}
pods40_1 <- rbind.data.frame(df2, df4, df6, df8)
row.names(pods40_1) <- c("rednia", "odch_stand", "skono", "kurtoza")
pods40_1
```
***

\
Wnioski:

  - nie wystpuje zale偶no midzy liczb danych a redni arytmetyczn - wartoci rednich arytmetycznych s bliskie wartoci parametru 	$位=1$ oraz $位=40$
  - wystpuje widoczna zale偶no midzy liczb danych a odchyleniem standardowym: wraz ze wzrostem liczby danych, odchylenie standardowe maleje
Oznacza to, 偶e wiksza liczba danych powoduje mniejsz zmienno 
  - wystpuj dodatnie oraz ujemne wartoci skonoci rozkadu - co wskazuje odpowiednio na asymetri prawostronn oraz lewostronn; pojawia si tu zale偶no: im wiksza warto k, tym mniejsza skono rozkadu
  - wartoci kurtozy s mniejsze oraz wiksze od 3, co wskazuje na wystpowanie zar贸wno rozkad贸w platokurtycznych, jak i leptokurtycznych
 
***

# Wariant drugi

## 0. Podstawowe charakterystyki rozkadu Poissona

*Tabela 2.1. Podstawowe statystyki dla danych z rozkadu Poissona z parametrem 位 = 1 podniesione do kwadratu*
```{r echo = FALSE}
data3 <- rpois(300, 1)^2

rednia <- mean(data3)
odch_stand <- sd(data3)
skono <- skewness(data3)
kurtoza <- kurtosis(data3)
statystyki3 <- data.frame(rednia, odch_stand, skono, kurtoza)
statystyki3
```

\
*Tabela 2.2. Podstawowe statystyki dla danych z rozkadu Poissona z parametrem 位 = 40 podniesione do kwadratu*
```{r echo = FALSE}
data4 <- rpois(300, 40)^2

rednia <- mean(data4)
odch_stand <- sd(data4)
skono <- skewness(data4)
kurtoza <- kurtosis(data4)
statystyki4 <- data.frame(rednia, odch_stand, skono, kurtoza)
statystyki4
```

\
```{r echo = FALSE, warning = FALSE}
x <- seq(0, 8, by = 1)
y <- dpois(x^2, lambda = 1)

plot(y, main = "Rozkad teoretyczny Poissona", xlab = "", ylab = "",pch = 21, bg = "red", cex = 1.3)
```

## 1-3. Wygenerowanie danych i wyliczenie redniej arytmetycznej

Zamiast N = 300, postanowiymy zamieni je na N = 800.

```{r echo = FALSE}
k <- c(5,10,20,30,50,100,200,500,1000)
```

Wylosowaymy dane z rozkadu Poissona z parametrami odpowiednio *位 = 1* 
oraz *位 = 40*, kt贸re nastepnie zostay poniesione do kwadratu. W poni偶szych tabelach umieciymy wyliczone rednie arytmetyczne tych danych dla konkretnych k.

\
*Tabela 2.3. Zestawienie wyznaczonych wartoci w zale偶noci od k*
*dla danych z rozkadu Poissona z parametrem 位 = 1 podniesionych do kwadratu*
```{r  echo = FALSE}

x <- (1:9)
lambda <- data.frame(NA)
lambda1_2 <- data.frame(x)

for (i in 2:801) {

lambda <- cbind(c(rpois(k[1], 1)^2, rep(NA, 995)),
                 c(rpois(k[2], 1)^2, rep(NA, 990)),
                 c(rpois(k[3], 1)^2, rep(NA, 980)),
                 c(rpois(k[4], 1)^2, rep(NA, 970)),
                 c(rpois(k[5], 1)^2, rep(NA, 950)),
                 c(rpois(k[6], 1)^2, rep(NA, 900)),
                 c(rpois(k[7], 1)^2, rep(NA, 800)),
                 c(rpois(k[8], 1)^2, rep(NA, 500)),
                 rpois(k[9], 1)^2
                 )

lambda1_2[,i] <- colMeans(lambda, na.rm = T)
lambda <- data.frame(NA)
i = i+1

}

lambda1_2 <- lambda1_2[,-c(1)]
rownames(lambda1_2) <- c("5","10","20","30","50","100","200","500","1000")

lambda1_2
```

\
*Tabela 2.4. Zestawienie wyznaczonych wartoci w zale偶noci od k*
*dla danych z rozkadu Poissona z parametrem 位 = 40 podniesionych do kwadratu*
```{r,  echo=FALSE, warning=FALSE}

y <- (1:9)
lambda <- data.frame(NA)
lambda40_2 <- data.frame(y)

for (i in 2:801) {

lambda <- cbind(c(rpois(k[1], 40)^2, rep(NA, 995)),
                 c(rpois(k[2], 40)^2, rep(NA, 990)),
                 c(rpois(k[3], 40)^2, rep(NA, 980)),
                 c(rpois(k[4], 40)^2, rep(NA, 970)),
                 c(rpois(k[5], 40)^2, rep(NA, 950)),
                 c(rpois(k[6], 40)^2, rep(NA, 900)),
                 c(rpois(k[7], 40)^2, rep(NA, 800)),
                 c(rpois(k[8], 40)^2, rep(NA, 500)),
                 rpois(k[9], 40)^2
                 )

lambda40_2[,i] <- colMeans(lambda, na.rm = T)
lambda <- data.frame(NA)
i = i+1

}

lambda40_2 <- lambda40_2[,-c(1)]
rownames(lambda40_2) <- c("5","10","20","30","50","100","200","500","1000")

lambda40_2
```
***

## 4. Podstawowe charakterystyki zbioru obliczonych rednich arytmetycznych

***

### rednia arytmetyczna

***
*Tabela 2.5. Zestawienie rednich arytmetycznych w zale偶noci od k* 
*dla danych z rozkadu Poissona z parametrem 位 = 1 podniesionych do kwadratu*
```{r echo = FALSE}
srednia3 <- round(apply(lambda1_2, 1, mean), 3)
df9 <- data.frame(t(srednia3))
names(df9) <- k
df9
```

\
```{r echo = FALSE}
ggplot() +
  geom_point(aes(y = k, x = round(apply(lambda1_2, 1, mean), 3)), 
             col = "steelblue4", size = 3.5) + 
   
  
  theme_light(base_size = 12) +
  labs(y = "k",
       x = "rednia arytmetyczna",
       title = "rednia arytmetyczna w zale偶noci od k",
       subtitle = "Dane pochodz z rozkadu Poissona o 位 = 1")
```

R贸偶nica w rozproszeniu wartoci rednich arytmetycznych w zale偶noci od k nie jest widoczna. 

***

*Tabela 2.6. Zestawienie rednich arytmetycznych w zale偶noci od k* 
*dla danych z rozkadu Poissona z parametrem 位 = 40 podniesionych do kwadratu*
```{r echo = FALSE}
srednia4 <- round(apply(lambda40_2, 1, mean), 3)
df10 <- data.frame(t(srednia4))
names(df10) <- k
df10
```

\
```{r echo = FALSE, warning = FALSE}
ggplot() +
  geom_point(aes(y = k, x = round(apply(lambda40_2, 1, mean), 3)), 
             col = "#9ACD32", size = 3.5) + 
  xlim(1635, 1643) +
  geom_line(aes(y = k, x = 1)) +
  theme_light(base_size = 12) +
  labs(y = "k",
       x = "rednia arytmetyczna",
       title = "rednia arytmetyczna w zale偶noci od k",
       subtitle = "Dane pochodz z rozkadu Poissona o 位 = 40")
```

<div style='text-align: justify;'> 
W tym przypadku zr贸偶nicowanie rednich arytmetycznych nie zale偶y od wartoci k. Wyliczone wartoci s bardzo odlege od wartoci oczekiwanej rozkadu wynoszcej 40.
</div>

***

### Odchylenie standardowe

***
*Tabela 2.7. Zestawienie odchyle standardowych w zale偶noci od k*
*dla danych z rozkadu Poissona z parametrem 位 = 1 podniesionych do kwadratu*
```{r echo = FALSE}
odch3 <- round(apply(lambda1_2, 1, sd), 3)
df11 <- data.frame(t(odch3))
names(df11) <- k
df11
```

\
```{r echo = FALSE}
ggplot() +
  geom_point(aes(y = k, x = round(apply(lambda1_2, 1, sd), 3)), 
             col = "steelblue4", size = 3.5) +
  theme_light(base_size = 12) +
  labs(y = "k",
       x = "Odchylenie standardowe",
       title = "Odchylenie standardowe w zale偶noci od k",
       subtitle = "Dane pochodz z rozkadu Poissona o 位 = 1")
```

Powy偶szy wykres jednoznacznie wskazuje na zale偶no pomidzy odchyleniem standardowym a wartoci k: im mniejsze k, tym odchylenie standardowe wy偶sze.

***

*Tabela 2.8. Zestawienie odchyle standardowych w zale偶noci od k*
*dla danych z rozkadu Poissona z parametrem 位 = 40 podniesionych do kwadratu*
```{r echo = FALSE}
odch4 <- round(apply(lambda40_2, 1, sd), 3)
df12 <- data.frame(t(odch4))
names(df12) <- k
df12
```

\
```{r echo = FALSE}
ggplot() +
  geom_point(aes(y = k, x = round(apply(lambda40_2, 1, sd), 3)), 
             col = "#9ACD32", size = 3.5) +
  theme_light(base_size = 12) +
  labs(y = "k",
       x = "Odchylenie standardowe",
       title = "Odchylenie standardowe obliczonych wartoci",
       subtitle = "Dane pochodz z rozkadu Poissona o 位 = 40")
```

Na powy偶szym wykresie ponownie mo偶na dostrzec zale偶no: im wiksze k, tym mniejsze odchylenie standardowe.

***

### Skono
\
*Tabela 2.9. Zestawienie wsp贸czynnik贸w skonoci w zale偶noci od k*
*dla danych z rozkadu Poissona z parametrem 位 = 1 podniesionych do kwadratu*
```{r echo = FALSE}
skosnosc3 <- round(apply(lambda1_2, 1, skewness), 3)
df13 <- data.frame(t(skosnosc3))
names(df13) <- k
df13
```

```{r echo = FALSE}
ggplot() +
  geom_point(aes(y = k, x = round(apply(lambda1_2, 1, skewness), 3)), 
             col = "steelblue4", size = 3.5) +
  theme_light(base_size = 12) +
  geom_line(aes(y = k, x = 0))+
  labs(y = "k",
       x = " Skono",
       title = "Skono w zale偶noci od k",
       subtitle = "Dane pochodz z rozkadu Poissona o 位 = 1")
```

<div style='text-align: justify;'>
Jak mo偶na odczyta z powy偶szego wykresu dla ka偶dego k wartoci wsp贸czynnika asymetrii s wiksze od zera. Dodatni wsp贸czynnik asymetrii wskazuje na asymetri prawostronn rozkadu. Oznacza to, 偶e wikszo wartoci jest mniejsza od redniej arytmetycznej. 
Ponadto mo偶na zauwa偶y, 偶e skono rozkadu jest zdecydowanie mniejsza dla du偶ych wartoci k.
</div>

***

*Tabela 2.10. Zestawienie wsp贸czynnik贸w asymetrii w zale偶noci od k*
*dla danych z rozkadu Poissona z parametrem 位 = 40 podniesionych do kwadratu*
```{r echo = FALSE}
skosnosc4 <- round(apply(lambda40_2, 1, skewness), 3)
df14 <- data.frame(t(skosnosc4))
names(df14) <- k
df14
```

\
```{r echo = FALSE}
ggplot() +
  geom_point(aes(y = k, x = round(apply(lambda40_2, 1, skewness), 3)), 
             col = "#9ACD32", size = 3.5)+
  theme_light(base_size = 12) +
  geom_line(aes(y = k, x = 0)) +
  labs(y = "k",
       x = " Skono",
       title = "Skono w zale偶noci od k",
       subtitle = "Dane pochodz z rozkadu Poissona o 位 = 40")
```

<div style='text-align: justify;'>
Podobnie jak we wczeniejszym przypadku wszystkie wartoci wsp贸czynnika skonoci s dodatnie co wiadczy o asymetrii prawostronnej rozkad贸w.
Jednak偶e wartoci wsp贸czynnik贸w s zdecydowanie mniejsze w por贸wnaniu z poprzednim przypadkiem. Utrzymuje si jednak zale偶no: im wiksze k, tym mniejsza skono. 
</div>

***

### Kurtoza

***
*Tabela 2.11. Zestawienie kurtozy w zale偶noci od k*
*dla danych z rozkadu Poissona z parametrem 位 = 1 podniesionych do kwadratu*
```{r echo = FALSE}
kurtoza3 <- round(apply(lambda1_2, 1, kurtosis), 3)
df15 <- data.frame(t(kurtoza3))
names(df15) <- k
df15
```

\
```{r echo = FALSE}
ggplot() +
  geom_point(aes(y = k, x = round(apply(lambda1_2, 1, kurtosis), 3)), 
             col = "steelblue4", size = 3.5) +
  theme_light(base_size = 12) +
  geom_line(aes(y = k, x = 3)) +
  labs(y = "k",
       x = "Kurtoza",
       title = "Kurtoza w zale偶noci od k",
       subtitle = "Dane pochodz z rozkadu Poissona o 位 = 1")
```

<div style='text-align: justify;'>
Ze wzgldu na nisk warto wsp贸czynnika skonoci mo偶emy interpretowa kurtoz. Zdecydowan wikszo wartoci charakteryzuje kurtoza wiksza od 3, co wskazuje na rozkady leptokurtyczne.
</div>

***

*Tabela 2.12. Zestawienie kurtozy w zale偶noci od k*
*dla danych z rozkadu Poissona z parametrem 位 = 40 podniesionych do kwadratu*
```{r echo = FALSE}
kurtoza4 <- round(apply(lambda40_2, 1, kurtosis), 3)
df16 <- data.frame(t(kurtoza4))
names(df16) <- k
df16
```

\
```{r echo = FALSE}
ggplot() +
  geom_point(aes(y = k, x = round(apply(lambda40_2, 1, kurtosis), 3)), 
             col = "#9ACD32", size = 3.5) +
  theme_light(base_size = 12) +
  geom_line(aes(y = k, x = 3)) +
  labs(y = "k",
       x = "Kurtoza",
       title = "Kurtoza w zale偶noci od k",
       subtitle = "Dane pochodz z rozkadu Poissona o 位 = 40")
```

W tym przypadku kurtoza przyjmuje wartoci zar贸wno mniejsze, jak i wiksze od 3, zatem wystpuj tu rozkady leptokurtyczne i platokurtyczne. Wyniki s bardzo zbli偶one do wartoci kurtozy dla rozkadu normalnego (K = 3). Oznacza to, 偶e W miar wzrostu parametru 位 rozkad coraz bardziej zbli偶a si do rozkadu normalnego.  

```{r echo = FALSE}
lambda1transponowana_2 <- t(lambda1_2)
lambda40transponowana_2 <- t(lambda40_2)
```

***

## 5. Wizualizacja danych

***

### Wykresy gstoci

*Zestawienie wykres贸w gstoci w zale偶noci od k*
*dla danych z rozkadu Poissona z parametrem 位 = 1 podniesionych do kwadratu*

```{r echo = FALSE, message = FALSE, warning = FALSE}

min <- -1
max <- 5

r1 <- D(lambda1transponowana_2[,1], "steelblue4", min , max)
r2 <- D(lambda1transponowana_2[,2], "steelblue4", min , max)
r3 <- D(lambda1transponowana_2[,3], "steelblue4", min , max)
r4 <- D(lambda1transponowana_2[,4], "steelblue4", min , max)
r5 <- D(lambda1transponowana_2[,5], "steelblue4", min , max)
r6 <- D(lambda1transponowana_2[,6], "steelblue4", min , max)
r7 <- D(lambda1transponowana_2[,7], "steelblue4", min , max)
r8 <- D(lambda1transponowana_2[,8], "steelblue4", min , max)
r9 <- D(lambda1transponowana_2[,9], "steelblue4", min , max)

plot_grid(r1, r2, r3, r4, align = "hv", label_x = 0.1, label_y = 0.95, 
          labels = c("k = 5", "k = 10", "k = 20", "k = 30"), label_size = 13)
plot_grid(r5, r6, r7, r8, align = "hv", label_x = 0.1, label_y = 0.95,
          labels = c("k = 50", "k = 100", "k = 200", "k = 500"), 
          label_size = 13)
plot_grid(r9, align = "hv", label_x = 0.1, label_y = 0.95, labels = "k = 1000", label_size = 13)
```

Na powy偶szych wykresach jednoznacznie wida zale偶no im wiksze k, tym krzywa gstoci jest bardziej "wysmuka" i skupiona wok贸 2.

***

*Zestawienie wykres贸w gstoci w zale偶noci od k*
*dla danych z rozkadu Poissona z parametrem 位 = 40 podniesionych do kwadratu*

```{r echo = FALSE, message = FALSE, warning = FALSE}
min <- 1000
max <- 2500

p1 <- D(lambda40transponowana_2[,1], "#9ACD32", min, max)
p2 <- D(lambda40transponowana_2[,2], "#9ACD32", min, max)
p3 <- D(lambda40transponowana_2[,3], "#9ACD32", min, max)
p4 <- D(lambda40transponowana_2[,4], "#9ACD32", min, max)
p5 <- D(lambda40transponowana_2[,5], "#9ACD32", min, max)
p6 <- D(lambda40transponowana_2[,6], "#9ACD32", min, max)
p7 <- D(lambda40transponowana_2[,7], "#9ACD32", min, max)
p8 <- D(lambda40transponowana_2[,8], "#9ACD32", min, max)
p9 <- D(lambda40transponowana_2[,9], "#9ACD32", min, max)
 
plot_grid(p1, p2, p3, p4, align = "hv", label_x = 0.12, label_y = 0.95, 
          labels = c("k = 5", "k = 10", "k = 20", "k = 30"), label_size = 13) 
plot_grid(p5, p6, p7, p8, align = "hv", label_x = 0.1, label_y = 0.95,
          labels = c("k = 50", "k = 100","k = 200","k = 500"), label_size = 13)
plot_grid(p9, align = "hv", label_x = 0.1, label_y = 0.95, labels = "k = 1000", label_size = 13)
```

<div style='text-align: justify;'>
Ponownie mo偶na zauwa偶y zale偶no midzy wartociami k a ksztatem krzywej gstoci. 
</div>

***

### Wykresy pudekowe

*Zestawienie wykres贸w pudekowych w zale偶noci od k*
*dla danych z rozkadu Poissona z parametrem 位 = 1 podniesionych do kwadratu*

```{r echo = FALSE}
boxplot(lambda1transponowana_2[,1], lambda1transponowana_2[,2],
        lambda1transponowana_2[,3], lambda1transponowana_2[,4],
        names = c("k = 5", "k = 10","k = 20","k = 30"))

boxplot(lambda1transponowana_2[,5], lambda1transponowana_2[,6],
        lambda1transponowana_2[,7],lambda1transponowana_2[,8],
        lambda1transponowana_2[,9],
        names = c("k = 50", "k = 100","k = 200","k = 500", "k = 1000"))
```

Na wykresach pudekowych jeszcze lepiej wida zw偶anie si rozkadu wraz ze wzrostem k. Prosz zwr贸ci uwag na zmian zakresu osi y midzy wykresami.

***

\
*Zestawienie wykres贸w pudekowych w zale偶noci od k*
*dla danych z rozkadu Poissona z parametrem 位 = 40 podniesionych do kwadratu*

```{r echo = FALSE}
boxplot(lambda40transponowana_2[,1], lambda40transponowana_2[,2],
        lambda40transponowana_2[,3], lambda40transponowana_2[,4],
        names = c("k = 5", "k = 10","k = 20","k = 30"))

boxplot(lambda40transponowana_2[,5], lambda40transponowana_2[,6],
        lambda40transponowana_2[,7], lambda40transponowana_2[,8],
        lambda40transponowana_2[,9],
        names = c("k = 50", "k = 100","k = 200","k = 500", "k = 1000"))
```


***

## 6. Badanie normalnoci rozkadu - test Shapiro-Wilka

Za pomoc testu Shapiro - Wilka dokonamy weryfikacji hipotezy o normalnoci badanego przez nas rozkadu. 

**Hipoteza 0: Badany rozkad jest normalny**

**Hipoteza 1: Badany rozkad nie jest normalny** 

poziom istotnoci 伪 = 0.1

*Tabela 2.13. Wartoci p-value dla testu Shapiro-Wilka przeprowadzonego na* *rozkadzie Poissona z parametrem 位 = 1, dla konkretnych k:*
```{r echo = FALSE}
Shapirotest1_2 <- data.frame(1,2,3,4,5,6,7,8,9)
Shapirotest40_2 <- data.frame(1,2,3,4,5,6,7,8,9)

Shapirotest1_2[1,1] <- shapiro.test(lambda1transponowana_2[,1])$p.value
Shapirotest1_2[1,2] <- shapiro.test(lambda1transponowana_2[,2])$p.value
Shapirotest1_2[1,3] <- shapiro.test(lambda1transponowana_2[,3])$p.value
Shapirotest1_2[1,4] <- shapiro.test(lambda1transponowana_2[,4])$p.value
Shapirotest1_2[1,5] <- shapiro.test(lambda1transponowana_2[,5])$p.value
Shapirotest1_2[1,6] <- shapiro.test(lambda1transponowana_2[,6])$p.value
Shapirotest1_2[1,7] <- shapiro.test(lambda1transponowana_2[,7])$p.value
Shapirotest1_2[1,8] <- shapiro.test(lambda1transponowana_2[,8])$p.value
Shapirotest1_2[1,9] <- shapiro.test(lambda1transponowana_2[,9])$p.value

colnames(Shapirotest1_2) <- c("5","10","20","30","50","100","200","500","1000")
round(Shapirotest1_2, 3)
```

Wizualizacja wynik贸w dla parametru 位 = 1.

Czarna linia na wykresie reprezentuje poziom istotnoci 伪 = 0.1.

Dla wszystkich przypadk贸w jakie wychodz ponad lini, nie ma podstaw do odrzucenia H0. Mo偶na zauwa偶y, 偶e odnosi si to do du偶ych wartoci k, poczwszy od k = 500.

Pocztkowo wartoci p-value s takie same i wynosz 0. Dla tych przypadk贸w nie ma podstaw aby stwierdzi, 偶e rozkad nie jest normalny. Ta waciwo utrzymuje si wraz ze wzrostem k a偶 do k = 500. 
```{r echo = FALSE}
ggplot() +
  geom_point(aes(x = k, y = t(Shapirotest1_2)[,1]), col = "steelblue4", 
             size = 3.5) +
  geom_line(aes(x = k, y = 0.1))+
  theme_light(base_size = 12) +
  labs(y = "p-value",
       x = "k",
       title = "Wartoci p-value dla testu Shapiro-Wilka",
       subtitle = "Dane pochodz z rozkadu Poissona o 位 = 1")
```

\
*Tabela 2.14. Wartoci p-value dla testu Shapiro-Wilka przeprowadzonego na* *rozkadzie Poissona z parametrem 位 = 40, dla konkretnych k:*
```{r echo = FALSE}
Shapirotest40_2[1,1] <- shapiro.test(lambda40transponowana_2[,1])$p.value
Shapirotest40_2[1,2] <- shapiro.test(lambda40transponowana_2[,2])$p.value
Shapirotest40_2[1,3] <- shapiro.test(lambda40transponowana_2[,3])$p.value
Shapirotest40_2[1,4] <- shapiro.test(lambda40transponowana_2[,4])$p.value
Shapirotest40_2[1,5] <- shapiro.test(lambda40transponowana_2[,5])$p.value
Shapirotest40_2[1,6] <- shapiro.test(lambda40transponowana_2[,6])$p.value
Shapirotest40_2[1,7] <- shapiro.test(lambda40transponowana_2[,7])$p.value
Shapirotest40_2[1,8] <- shapiro.test(lambda40transponowana_2[,8])$p.value
Shapirotest40_2[1,9] <- shapiro.test(lambda40transponowana_2[,9])$p.value

colnames(Shapirotest40_2) <- c("5","10","20","30","50","100", "200","500",                                    "1000")
round(Shapirotest40_2, 3)
```
\

Wizualizacja wynik贸w dla parametru 位 = 40.

Nie mo偶na zatem stwierdzi wystpowania zale偶noci: im wiksze k, tym wiksza warto p-value. 

```{r echo = FALSE}
ggplot() +
  geom_point(aes(x = k, y = t(Shapirotest40_2)[,1]), col = "#9ACD32", 
             size = 3.5) +
  geom_line(aes(x = k, y = 0.1)) +
  theme_light(base_size = 12) +
  labs(y = "p-value",
       x = "k",
       title = "Wartoci p-value dla testu Shapiro-Wilka",
       subtitle = "Dane pochodz z rozkadu Poissona o 位 = 1")
```

### Podsumowanie

\
W poni偶szych tabelach zamieszczone zostay zestawienia podstawowych charakterystyk rozkadu w zale偶noci od liczby danych wykorzystanych do obliczenia redniej (k).

***
*Tabela 2.15. Zestawienie podstawowych statystyk w zale偶noci od k*
*dla danych z rozkadu Poissona z parametrem 位 = 1 podniesionych do kwadratu*
```{r echo = FALSE}
pods1_2 <- rbind.data.frame(df9, df11, df13, df15)
row.names(pods1_2) <- c("rednia", "odch_stand", "skono", "kurtoza")
pods1_2
```
\

*Tabela 2.16. Zestawienie podstawowych statystyk w zale偶noci od k*
*dla danych z rozkadu Poissona z parametrem 位 = 40 podniesionych do kwadratu*
```{r echo = FALSE}
pods40_2 <- rbind.data.frame(df10, df12, df14, df16)
row.names(pods40_2) <- c("rednia", "odch_stand", "skono", "kurtoza")
pods40_2
```

\
Wnioski:

  - nie wystpuje zale偶no midzy liczb danych (k) a redni arytmetyczn - wartoci rednich arytmetycznych s bliskie wartoci parametru 	$位^{2}=1^{2}=1$ oraz $位^{2}=40^{2}=1600$
  - wystpuje widoczna zale偶no midzy liczb danych (k) a odchyleniem standardowym: wraz ze wzrostem liczby danych, odchylenie standardowe maleje
Oznacza to, 偶e wiksza liczba danych powoduje mniejsz zmienno 
  - skonoci rozkadu s dodatnie - co wskazuje na asymetri prawostronn, czyli wikszo danych przyjmuje wartoci poni偶ej przecitnej; pojawia si tu zale偶no: im wiksza warto k, tym mniejsza skono rozkadu
  - wartoci kurtozy s przewa偶nie wiksze od 3, co wskazuje na du偶e skupienie wynik贸w wok贸 redniej i ich mae zr贸偶nicowanie (rozkad leptokurtyczny) 
